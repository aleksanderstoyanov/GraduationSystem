<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:th="http://www.thymeleaf.org">
<head th:replace="common/fragments :: head">
</head>
<body>
<nav th:replace="common/fragments :: header">
</nav>
<main>
    <div class="container">
        <div class="row col-md-8 offset-md-2">
            <div class="card">
                <div class="card-header">
                    <h2 class="text-center">Update User</h2>
                </div>
                <div class="card-body">
                    <form method="post" role="form" th:object="${user}">
                        <div class="form-group mb-3">
                            <label class="form-label">First Name</label>
                            <input
                                    class="form-control"
                                    id="firstName"
                                    name="firstName"
                                    placeholder="Enter first name"
                                    th:field="*{firstName}"
                                    type="text"
                            />
                            <p th:errors="*{firstName}" class="text-danger"
                               th:if="${#fields.hasErrors('firstName')}"></p>
                        </div>

                        <div class="form-group mb-3">
                            <label class="form-label">Last Name</label>
                            <input
                                    class="form-control"
                                    id="lastName"
                                    name="lastName"
                                    placeholder="Enter last name"
                                    th:field="*{lastName}"
                                    type="text"
                            />
                            <p th:errors="*{lastName}" class="text-danger"
                               th:if="${#fields.hasErrors('lastName')}"></p>
                        </div>

                        <div class="form-group mb-3">
                            <label class="form-label">Email</label>
                            <input
                                    class="form-control"
                                    id="email"
                                    name="email"
                                    placeholder="Enter email address"
                                    th:field="*{email}"
                                    type="email"
                            />
                            <p th:errors="*{email}" class="text-danger"
                               th:if="${#fields.hasErrors('email')}"></p>
                        </div>
                        <div class="form-group mb-3">
                            <label class="form-label">EGN</label>
                            <input
                                    class="form-control"
                                    id="egn"
                                    name="egn"
                                    placeholder="Update EGN"
                                    th:field="*{egn}"
                                    type="text"
                            />
                            <p th:errors="*{egn}" class="text-danger"
                               th:if="${#fields.hasErrors('egn')}"></p>
                        </div>
                        <div class="form-group mb-3">
                            <label class="form-label">Faculty</label>
                            <select class="form-select" th:field="*{faculty}" aria-label="Default select example">
                                <option th:each="faculty : ${faculties}" th:text="${faculty}"
                                        th:value="${faculty}"></option>
                            </select>
                        </div>
                        <div class="form-group mb-3">
                            <label class="form-label">Role</label>
                            <select id="role" onchange="onChange()" th:field="*{role}"  class="form-select"
                                    aria-label="Default select example">
                                <option th:selected="${user.role} == ${role} ? true : false" th:value="${role}"
                                        th:text="${role}" th:each="role: ${roles}"></option>
                            </select>
                        </div>
                        <div class="form-group mb-3" style="display:none">
                            <label class="form-label">Position</label>
                            <select id="position" class="form-select" th:field="*{position}" aria-label="Default select example">
                                <option th:selected="${user.position} == ${position} ? true : false"
                                        th:value="${position}" th:text="${position}"
                                        th:each="position: ${positions}"></option>
                            </select>
                        </div>
                        <div class="form-group">
                            <button class="btn btn-primary" type="submit">Update <i class="fa-solid fa-floppy-disk"></i>
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</main>
<script>
  function togglePosition(){
    var role = $("#role").val();
    var positionContainer = $("#position").parents(".form-group").first();

    if(role == "TEACHER"){
       positionContainer.show();
    }
    else{
       positionContainer.hide();
    }
  }
  $(document).ready(function(){
        togglePosition();
  })
  function onChange(){
        togglePosition();
  }
</script>
<style>
        .container{
            margin-top: 5%
        }

</style>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL"
        crossorigin="anonymous"></script>
</body>
<footer th:replace="common/fragments :: footer">
</footer>
</body>

</html>